
Now that we have gotten a lot of the initial foundation done we have a place to build our lab environment in. On this page I am going to walk through setting up Windows in our lab environment. I am going to start with a Windows Server 2025 VM, promote it to domain controller, and join a Windows 11 workstation machine to it to simulate a small office environment. Later on I will install network sensors and feed logs up into a SIEM so we can do some real security stuff.

# Windows Server

Microsoft developed Windows Server as a solution to manage organization's Active Directories, DNS, DHCP, Group Policy all from a centralized location. You can set servers to act as Domain Controllers, Certificate Authorities and other important network appliances to organize company data and digital environments. In our case we will use it mainly as an Domain Controller so we can have an Active Directory domain in an attempt to simulate a real organization. 

## Download & Install

As with any virtual machine in Proxmox, setting it up begins with loading the ISO file into the hypervisor so it can be used to install the machine. To download Windows Server 2025 to our proxmox machine I am going to use the following commands:

```
STORAGEPATH="/var/lib/vz/template/iso"
ISO_URL="https://go.microsoft.com/fwlink/?linkid=2293312&clcid=0x409&culture=en-us&country=us"
wget -c -L -O "${STORAGEPATH}/WinSrv2025_EVAL_en-us.iso" "${ISO_URL}"
```

To confirm the download was successful I can go to `Datacenter > [Node] > local([Node]) `. Here we can see it downloaded into our ISO bin.

![[2. Windows Environment-1.png]]

Confirm you see the ISO here, then click the Create VM button in the top right corner of the Proxmox portal to open the Create VM wizard again. I'm going to give the server install these values:

- **VM ID**: 902
- **Name**: WinServer-Lab
- **Guest OS Type**: Microsoft Windows
- **Disk size**: 60
- **CPU Cores**: 4
- **Memory**: 6144
- **Bridge**: vmbr1

Once these settings are in place and the VM is built, go ahead and turn it on. You will need to go to `Datacenter > [Node] > WinServer-Lab > Console` to view the Windows installation wizard. 

![[2. Windows Environment-2.png]]

Make sure to select the Standard Evaluation (Desktop Experience) version of the install. Click Next, Accept the licensing terms, then choose the hard drive it will install on. There should only be the 60 GB VM drive we created earlier.

![[2. Windows Environment-3.png]]

Once the installer kicks off you can sit back and let Windows do its thing for a few minutes. Eventually you will be prompted to enter an Administrator password. Create a secure one, then log into the machine. With Proxmox you may need to use the NoVNC sidebar to send the CTRL+ALT+DEL button presses to the machine. 

Once logged in, open Command Prompt and run a ping to the pfSense router IP to make sure it is connected correctly.

![[2. Windows Environment-4.png]]

