
# Previous [[2. Windows Environment]]

Security Onion is a Swiss Army Knife of security tools that has several different systems built in such as Zeek, Suricata, osquery and can be used to monitor networks and capture network packets. For this lab we will use it mainly as a network monitor that will forward Zeek logs to Splunk for log analysis. 

# Download ISO

Installing Security Onion is similar to the other VMs so far. First we need to download the ISO to Proxmox, then build out a VM for it in the Wizard. Here's a few commands you can use to download Security Onion from the Proxmox terminal:

```
STORAGEPATH="/var/lib/vz/template/iso"
VERSION="2.4.180-20250916"
ISO="securityonion-${VERSION}.iso"
ISO_URL="https://download.securityonion.net/file/securityonion/${ISO}"

wget -c -L -O "${STORAGEPATH}/${ISO}" "${ISO_URL}"
```

The ISO file is rather large (14GB) so you may want to go take a break while waiting for this to finish. Once its done you can click the Create VM in the top right corner of Proxmox to start the wizard. I used the following config for Security Onion:

- **VM ID**: 904
- **Name**: SecOnion-Lab
- **Disk size**: 250GB
- **CPU Cores**: 4
- **Memory**: 24GB
- **Bridge**: vmbr1

# SPAN port

Before turning on the machine and installing Security Onion we will need to make some changes to the network settings. Security Onion has the ability to listen to the network on a second port on the network called a SPAN port that allows it to hear all traffic flowing through the network, not just those intended for the SO machine or broadcasts to all machines. This means Security Onion can hear two other machines on the network talking to each other, which would be impossible only using the one standard network connection. 

![[3. Security Onion-1.png]]

We will need to make some changes within Proxmox to allow for this. Specifically we will want to make another network interface `vmbr2` and mirror all of the traffic from `vmbr1` to it. All of the lab machines will connect to `vmbr1` and it will share this to `vmbr2` so that Security Onion can monitor it. 

First let's create `vmbr2` by going to `Datacenter > [Node] > System > Network > Create > Linux Bridge`. 

- **Name**: vmbr2
- **IPv4/IPv6**: None
- **Bridge ports**: Blank 

Then click Create > Apply Configuration to save the settings. Next we need to attach `vmbr2` to our Security Onion VM by going to `Datacenter > [Node] > SecOnion-Lab > Hardware > Add > Network Device`. Use the following settings:

- **Model**: VirtIO (paravirtualized)
- **Bridge**: vmbr2
- **Firewall**: Unchecked

